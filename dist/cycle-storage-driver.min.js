(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.CycleStorageDriver=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=storageDriver;var _writeToStore=require("./writeToStore");var _writeToStore2=_interopRequireDefault(_writeToStore);var _responseCollection=require("./responseCollection");var _responseCollection2=_interopRequireDefault(_responseCollection);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function storageDriver(request$){request$.subscribe(function(request){return(0,_writeToStore2.default)(request)});return(0,_responseCollection2.default)(request$)}},{"./responseCollection":2,"./writeToStore":4}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function(request$){return{get local(){return(0,_util2.default)(request$)},get session(){return(0,_util2.default)(request$,"session")}}};var _util=require("./util");var _util2=_interopRequireDefault(_util);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}},{"./util":3}],3:[function(require,module,exports){(function(global){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=getResponseObj;var _rx=typeof window!=="undefined"?window["Rx"]:typeof global!=="undefined"?global["Rx"]:null;var _rx2=_interopRequireDefault(_rx);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function getStorage$(request$,type){return _rx2.default.Observable.if(function(){return type==="local"},request$.filter(function(req){return!req.target||req.target==="local"}),request$.filter(function(req){return req.target==="session"}))}function storageKey(n,request$){var type=arguments.length<=2||arguments[2]===undefined?"local":arguments[2];var storage$=getStorage$(request$,type);var key=type==="local"?localStorage.key(n):sessionStorage.key(n);return storage$.filter(function(req){return req.key===key}).map(function(req){return req.key}).startWith(key).distinctUntilChanged()}function storageGetItem(key,request$){var type=arguments.length<=2||arguments[2]===undefined?"local":arguments[2];var storage$=getStorage$(request$,type);var storageObj=type==="local"?localStorage:sessionStorage;return storage$.filter(function(req){return req.key===key}).map(function(req){return req.value}).startWith(storageObj.getItem(key))}function getResponseObj(request$){var type=arguments.length<=1||arguments[1]===undefined?"local":arguments[1];return{key:function key(n){return storageKey(n,request$,type)},getItem:function getItem(key){return storageGetItem(key,request$,type)}}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function writeToStore(_ref){var _ref$target=_ref.target;var target=_ref$target===undefined?"local":_ref$target;var _ref$action=_ref.action;var action=_ref$action===undefined?"setItem":_ref$action;var key=_ref.key;var value=_ref.value;var storage=target==="local"?localStorage:sessionStorage;storage[action](key,value)}exports.default=writeToStore},{}]},{},[1])(1)});